name: soil-cli

on:
  push:
    branches: ["**"]
  pull_request:

jobs:
  soil-cli-checks:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Micromamba
        uses: mamba-org/setup-micromamba@v2
        with:
          environment-file: environment.ci.yml
          environment-name: fire-debrisflow-ml-ci
          cache-environment: true
          init-shell: bash

      - name: Unit Tests
        shell: bash -l {0}
        run: |
          pytest -q tests/test_soil_data_core.py

      - name: Soil CLI Smoke Test
        shell: bash -l {0}
        run: |
          python scripts/smoke_test_soil_cli.py
